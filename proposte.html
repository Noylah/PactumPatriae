<!DOCTYPE html>
<html lang="it">
<head>
    <script>
        (function() {
            if (sessionStorage.getItem('staffAccess') !== 'true') {
                window.location.replace('login.html');
            }
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ᴘʀᴏᴘᴏsᴛᴇ • Pactum Patriae</title>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,600;1,600&family=Public+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style-staff.css">
    <link rel="icon" href="img/favicon.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        html, body { height: auto; min-height: 100%; overflow-y: auto; }
        .dashboard-wrapper { min-height: 100vh; height: auto; display: flex; }
        .work-area { flex: 1; height: auto; min-height: 100vh; overflow-y: visible; padding-bottom: 50px; }

        .proposta-link-table { color: #fff !important; text-decoration: none; font-weight: 600; transition: 0.2s; }
        .proposta-link-table:hover { color: #d4af37 !important; }

        .status-badge {
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.65rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .feedback-row { background: rgba(0, 0, 0, 0.2); display: none; }
        .feedback-row.active { display: table-row; animation: fadeIn 0.3s ease; }
        .feedback-content { padding: 25px; border-left: 3px solid #d4af37; color: #ccc; font-size: 0.9rem; line-height: 1.6; }
        .clickable-row { cursor: pointer; transition: 0.2s; }
        .clickable-row:hover { background: rgba(255, 255, 255, 0.03); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="staff-body" style="opacity: 0; transition: opacity 0.5s;">
    <div class="dashboard-wrapper">
        <aside class="side-panel">
            <div class="panel-top">
                <img src="img/LogoPP.jpg" alt="Logo" class="panel-logo">
                <span class="panel-title">Pactum Patriae</span>
                <span class="panel-subtitle">Dashboard Staff</span>
            </div>
            
            <nav class="panel-menu">
                <a id="nav-proposte" href="proposte.html" class="panel-link active">
                    <span class="dot"></span> Proposte Personali
                </a>
                <a id="nav-staff" href="staff.html" class="panel-link">
                    <span class="dot"></span> Registro Consiglieri
                </a>
                <a id="nav-riunioni" href="riunioni.html" class="panel-link">
                    <span class="dot"></span> Archivio Riunioni
                </a>
                <a id="nav-bilancio" href="bilancio.html" class="panel-link">
                    <span class="dot"></span> Registro Economico
                </a>
                <a id="nav-notizie" href="notizie.html" class="panel-link">
                    <span class="dot"></span> Gestione Notizie
                </a>
                <a id="nav-gestione" href="gestioneproposte.html" class="panel-link">
                    <span class="dot"></span> Gestione Proposte
                </a>
                <a id="nav-credenziali" href="credenziali.html" class="panel-link">
                    <span class="dot"></span> Gestione Credenziali
                </a>
            </nav>

            <div class="panel-bottom">
                <button class="btn-logout-dash" onclick="logout()">Logout</button>
            </div>
        </aside>

        <main class="work-area">
            <header class="work-header" style="margin-bottom: 30px;">
                <div class="header-info">
                    <span class="badge-mini">Proposte</span>
                    <h1 style="font-family: 'Crimson Pro'; font-size: 2.2rem;">Le Tue Proposte</h1>
                </div>
            </header>

            <section class="glass-table-card" style="padding: 25px; margin-bottom: 40px; border: 1px solid rgba(212,175,55,0.2);">
                <h3 style="color: #d4af37; margin: 0 0 20px 0; font-family: 'Crimson Pro'; font-size: 1.2rem;">✦ Nuova Proposta</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <input type="text" id="nuovaPropostaTitolo" placeholder="Titolo della proposta..." class="minimal-input">
                    <input type="text" id="nuovaPropostaLink" placeholder="Link Documento..." class="minimal-input">
                    <button id="btn-deposito-main" onclick="aggiungiProposta()" class="btn-gold-action" style="grid-column: span 2; height: 45px;">DEPOSITA PROPOSTA</button>
                </div>
            </section>

            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; padding: 0 5px;">
                <h2 style="font-family: 'Crimson Pro'; font-size: 1.5rem; color: #fff; margin: 0;">Registro Proposte Personali</h2>
                <span id="counter-proposte" style="font-size: 0.65rem; color: #d4af37; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;">0 PROPOSTE</span>
            </div>

            <section class="glass-table-card">
                <div class="table-scroll">
                    <table class="dash-table">
                        <thead>
                            <tr>
                                <th style="text-align: left;">Titolo Proposta</th>
                                <th style="text-align: center;">Data</th>
                                <th style="text-align: center;">Stato</th>
                                <th style="text-align: right;">Operazioni</th>
                            </tr>
                        </thead>
                        <tbody id="listaProposte-body"></tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>
    <script src="proposte.js"></script>
</body>
</html>